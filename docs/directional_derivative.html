<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Math 3D</title>
    
    <script src="resources/mathbox-bundle.js"></script>
    <link rel="stylesheet" href="resources/mathbox.css">
    
    <script src="math3d.js"></script>
    <link rel="stylesheet" href="math3d.css">
    
    <script src="resources/dat.gui.js"></script>
    <link rel="stylesheet" href="resources/dat-gui-custom.css">
    
    <script src="https://code.jquery.com/jquery-2.2.4.min.js" integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=" crossorigin="anonymous"></script>
    <script src="
    https://cdnjs.cloudflare.com/ajax/libs/mathjs/3.5.3/math.js"></script>

    <meta name="viewport" content="initial-scale=1, maximum-scale=1">
</head>
<body>
<div id="my-math-box"></div>
<script>

var queryString = Utility.getQueryString();
var encodedUserSettings = queryString['settings'];

function diffX(func, h){
    var h = Utility.defaultVal(h,0.01);
    return (x,y) => math.divide( math.subtract( func(x+0.5*h,y) , func(x-0.5*h,y) ), h )
}
function diffY(func, h){
    var h = Utility.defaultVal(h,0.01);
    return (x,y) => math.divide( math.subtract( func(x,y+0.5*h) , func(x,y-0.5*h) ), h )
}

// var f = (x,y) => 3-x*x - y*y +   x*y;

var f = (x,y) => x*x + y

// var vel_vector =

var authorSettings = {
    containerId:'my-math-box',
    mathScope: {x0:-1,y0:2, r:1, Q:0, f:f},
    scale: [1,1,0.5],
    wrappedMathObjects:[
        {
            type: 'ParametricSurface',
            settings: {rawExpression: '[u, v, f(u,v)]', range:`[[-3,3],[-3,3]]`,color:'lightcoral',opacity:0.75,shaded:true}
        },
        {
            type: 'ParametricCurve',
            settings: {rawExpression: '[x0 + t*cos(Q), y0+t*sin(Q), f(x0 + t*cos(Q),y0+t*sin(Q))]', range:`[-1,1]`,color:'blue'}
        },
        {
            type: 'Point',
            settings: {rawExpression:'[[x0,y0,f(x0,y0)]]', color:'blank'}
        },
        {
            type: 'Vector',
            settings: {rawExpression:'[[x0,y0,f(x0,y0)+0.2], [x0+r*cos(Q), y0+r*sin(Q),f(x0,y0)+0.2]]'}
        }
    ]
};

var settings = encodedUserSettings===undefined ? authorSettings : Math3D.decodeSettingsAsURL64(encodedUserSettings);

var math3d = new Math3D(settings);

var gui = new dat.GUI();

gui.add(math3d.mathScope, "x0")
    .min(-3)
    .max(3)
    .step(0.01);

gui.add(math3d.mathScope, "y0")
    .min(-3)
    .max(3)
    .step(0.01);

gui.add(math3d.mathScope, "Q")
    .min(0)
    .max(2*Math.PI)
    .step(0.01);


</script>

</body>
</html>
